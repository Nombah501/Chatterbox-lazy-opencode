# Research Report — 2026-01-07

## Контекст
- Проект: Chatterbox lazy opencode
- Цель: выбор техстека, риски и лицензии, лучшие практики
- Ориентир: полный функционал AgentVibes, но для OpenCode CLI
- Среда: Manjaro KDE (Linux), Chatterbox локально, облако допустимо

## Ключевые источники
- AgentVibes README: https://raw.githubusercontent.com/paulpreibisch/AgentVibes/master/README.md
- Chatterbox README: https://raw.githubusercontent.com/resemble-ai/chatterbox/master/README.md
- OpenCode Plugins: https://opencode.ai/docs/plugins/
- OpenCode CLI docs: https://opencode.ai/docs/cli/

## Рекомендации по техстеку (best practices)
- CLI и плагины: Node.js + TypeScript, т.к. OpenCode расширяется через плагины на JS/TS и это снижает интеграционные риски.
- TTS‑движок: Python 3.11 + `chatterbox-tts` (локально), соответствует официальной установке и зависимостям Chatterbox.
- Связка Node ↔ Python: отдельный локальный worker/daemon (HTTP/Unix socket или stdio‑IPC), чтобы не блокировать CLI и изолировать тяжелые зависимости.
- Установка: npm‑дистрибуция для CLI/плагина, Python‑часть ставится отдельно или через установщик‑скрипт.

## Архитектура и best practices
- Поток обработки: ответы ассистентов → синтез итогов (summary) → расхождения → ссылки/цитаты‑источники.
- TTS включается по событию: итог/алерт/подтверждение; отключается в CI и неинтерактивных окружениях.
- Прозрачность: хранить исходные ответы и цитаты, чтобы пользователь мог сверить синтез.
- Настройки: голос, скорость, язык, формат аудио, уровень детализации вывода.

## Риски
- Ресурсы: Chatterbox может требовать GPU/VRAM для комфортной скорости; на CPU возможны задержки.
- Системные зависимости Linux: воспроизведение аудио (paplay/aplay/mpv), sox/ffmpeg для эффектов или обработки; возможны проблемы настройки.
- UX‑риски: без четкого формата «итог/расхождения» вывод становится шумным.
- Скопировать весь функционал AgentVibes = высокая поддержка и рост scope.

## Лицензии
- AgentVibes: Apache‑2.0 — разрешительная, требует сохранения уведомлений/NOTICE.
- Chatterbox: MIT — разрешительная.
- Рекомендация по зависимостям: предпочитать MIT/Apache‑2.0/BSD‑2/3, избегать GPL/AGPL/SSPL, если не хотите copyleft‑ограничений.

## Вывод
Рекомендуемый базовый стек: Node.js/TypeScript для CLI/плагинов OpenCode + Python 3.11 для Chatterbox. Архитектура — модульная: тонкий CLI‑core и отдельный TTS‑воркер. Основные риски связаны с ресурсами TTS и системными зависимостями Linux.

## Открытые вопросы
- Нужно ли обеспечивать полную совместимость с командами AgentVibes или только функционально повторить поведение?
- Какой режим вывода считать “как у AgentVibes” (структура секций, стиль, интерактивность)?
- Нужен ли режим без TTS по умолчанию и авто‑детект CI/SSH окружений?
