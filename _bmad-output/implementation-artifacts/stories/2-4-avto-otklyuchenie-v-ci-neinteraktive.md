# Story 2.4 — Авто-отключение в CI/неинтерактиве

- Epic: 2 — Озвучка и управление TTS
- Priority: High
- Estimate: 2 SP
- Status: done

## Краткое описание
Автоматически отключать TTS в CI и неинтерактивных режимах.

## Ценность
Исключает нежелательный звук и сбои в автоматизации.

## Критерии приемки
- При обнаружении CI/неинтерактивного режима озвучка не запускается.
- Текстовый вывод сохраняется без изменений.
- Поведение не требует ручных действий пользователя.

## Зависимости
- Story 2.1 (управление состоянием TTS).

## Ссылки
- `_bmad-output/implementation-artifacts/sprint-1-checklists.md` (Story 2.4)

## Tasks
- [x] Реализовать детектор CI/неинтерактивного режима.
- [x] Интегрировать проверку перед запуском TTS.
- [x] Добавить лог/сообщение о причине отключения.

## Subtasks
- [x] Создать функцию _is_ci_or_noninteractive().
- [x] Добавить проверку в _maybe_speak().

## Dev Agent Record
- Date: 2026-01-07
- Agent: Codex
- Notes: Реализован авто-детект и отключение TTS в CI/неинтерактива.

## File List
- src/chatterbox_lazy_opencode/cli.py

## Change Log
- 2026-01-07: Добавлены Tasks/Subtasks для Story 2.4.
- 2026-01-07: Реализован детектор CI/неинтерактивного режима и интеграция в CLI.

## Status
- Выполнено
