# Story 1.1 — Синтез итогов и расхождений

- Epic: 1 — Прозрачный синтез результатов
- Priority: High
- Estimate: 5 SP
- Status: review

## Краткое описание
Формировать секции «Итог» и «Расхождения» из нескольких ответов агентов в стабильном формате.

## Ценность
Пользователь быстро получает итог и ключевые расхождения без чтения всего текста.

## Критерии приемки
- Дано несколько ответов агентов, когда запускается синтез, тогда вывод содержит секции «Итог» и «Расхождения».
- Итог не равен механически первому ответу при наличии расхождений.
- Итог по умолчанию краткий (3–5 предложений).
- Порядок секций соответствует «Итог -> Расхождения -> Цитаты» (если цитаты включены).
- Текстовый вывод не блокируется длительными операциями.

## Зависимости
- Минимальный контракт входных данных от агентов.

## Ссылки
- `_bmad-output/implementation-artifacts/sprint-1-checklists.md` (Story 1.1)
- `_bmad-output/implementation-artifacts/synthesis-rules-2026-01-07.md`

## Tasks
- [x] Зафиксировать формат вывода «Итог» и «Расхождения».
- [x] Реализовать правила синтеза итога по Story 1.1.
- [x] Реализовать стабильные расхождения и обработку пустых входов.

## Subtasks
- [x] Ввести нормализацию для сравнения ответов.
- [x] Сформировать итог 3–5 предложений с учетом расхождений.
- [x] Сформировать список расхождений в детерминированном порядке.

## Dev Agent Record
- Date: 2026-01-07
- Agent: Codex
- Notes: Реализованы правила синтеза итогов и расхождений.

## File List
- src/chatterbox_lazy_opencode/synthesis.py

## Change Log
- 2026-01-07: Добавлены Tasks/Subtasks для Story 1.1.
- 2026-01-07: Обновлен синтез итога и расхождений по правилам Story 1.1.

## Status
- На ревью
